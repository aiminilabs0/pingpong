<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI PingPong</title>
    <link rel="icon" href="images/favicon.ico" type="image/svg+xml" />
    <!-- Bump this value on deploy to bust browser caches for local assets (CSS/JS). -->
    <meta name="app-version" content="0.0.14" />
    <script>
        (function () {
            const v = document.querySelector('meta[name="app-version"]')?.content || "";
            const qs = v ? `?v=${encodeURIComponent(v)}` : "";
            document.write(`<link rel="stylesheet" href="main.css${qs}" />`);
            document.write(`<script src="data.js${qs}"><\/script>`);

            // Ensure ES module dependency imports under /js/ also get the same cache-busting version.
            // This is needed because `js/main.js?v=...` does NOT automatically propagate to `import './x.js'`.
            // Map the *resolved* dependency URLs (e.g. "/js/i18n.js") to versioned URLs.
            // Relative imports like `import "./i18n.js"` from /js/main.js resolve to "/js/i18n.js".
            const importMap = {
                imports: {
                    "/js/i18n.js": `/js/i18n.js${qs}`,
                    "/js/url-manager.js": `/js/url-manager.js${qs}`,
                    "/js/tooltip.js": `/js/tooltip.js${qs}`,
                    "/js/chart-manager.js": `/js/chart-manager.js${qs}`,
                    "/js/constants.js": `/js/constants.js${qs}`,
                    "/js/youtube-embed.js": `/js/youtube-embed.js${qs}`,
                    "/js/color-utils.js": `/js/color-utils.js${qs}`,
                    "/js/markdown.js": `/js/markdown.js${qs}`
                }
            };
            document.write(`<script type="importmap">${JSON.stringify(importMap)}<\/script>`);
        })();
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
</head>
<body>

<div class="container">
    <!-- Header -->
    <header class="hero">
        <h1 class="hero__title" data-i18n="heroTitle">ğŸ“ AI PingPong</h1>
        <p class="hero__subtitle subtitle" data-i18n="heroSubtitle">Table Tennis Rubber Comparison Tool</p>
    </header>

    <!-- Controls -->
    <div class="controls">
        <div class="tabs brand-tabs" role="tablist" aria-label="Brand" id="brandTabs">
            <button class="tab brand-tab active" type="button" role="tab" aria-selected="true" data-brand="Butterfly">
                <img src="images/butterfly.ico" alt="" aria-hidden="true" />
                <span data-i18n="brandButterfly">Butterfly</span>
            </button>
            <button class="tab brand-tab" type="button" role="tab" aria-selected="false" data-brand="Tibhar">
                <img src="images/tibhar.png" alt="" aria-hidden="true" />
                <span data-i18n="brandTibhar">Tibhar</span>
            </button>
            <button class="tab brand-tab" type="button" role="tab" aria-selected="false" data-brand="XIOM">
                <img src="images/xiom.png" alt="" aria-hidden="true" />
                <span data-i18n="brandXiom">XIOM</span>
            </button>
        </div>

        <div class="lang-switch" aria-label="Country">
            <span class="select-wrap">
                <select id="countrySelect" class="country-select" aria-label="Country">
                    <option value="kr">ğŸ‡°ğŸ‡· Korea</option>
                    <option value="us">ğŸ‡ºğŸ‡¸ USA</option>
                </select>
            </span>
        </div>
    </div>

    <!-- Chart -->
    <section class="chart-wrapper">
        <div class="chart-header">
            <div class="chart-header__left">
                <h2 class="chart-title" data-i18n="chartTitle">Rubber Performance Matrix</h2>
                <p class="chart-subtitle" data-i18n="chartSubtitle">
                    Compare speed and spin characteristics across different rubber models
                </p>

                <div class="compare-instruction" aria-hidden="true">
                    <span class="compare-instruction__line" data-i18n="compareInstrLine"></span>
                </div>
            </div>

            <div class="chart-header__right" aria-hidden="true">
                <div class="hardness-legend">
                    <div class="content">
                        <div class="row">
                            <span class="bar" data-i18n="legendHardness">Hardness</span>
                        </div>
                        <div class="example">
                            <div class="ex-line">
                                <span class="country flag" title="Germany">ğŸ‡©ğŸ‡ª</span>
                                <div class="nums">
                                    <span class="n left">40</span>
                                    <span class="n mid">47.5</span>
                                    <span class="n right">55</span>
                                </div>
                            </div>
                            <div class="ex-line">
                                <span class="country flag" title="Japan">ğŸ‡¯ğŸ‡µ</span>
                                <div class="nums">
                                    <span class="n left">33</span>
                                    <span class="n mid">36</span>
                                    <span class="n right">44</span>
                                </div>
                            </div>
                            <div class="ex-line">
                                <span class="country flag" title="China">ğŸ‡¨ğŸ‡³</span>
                                <div class="nums">
                                    <span class="n left">35</span>
                                    <span class="n mid">39</span>
                                    <span class="n right">41</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="canvas-wrap">
            <canvas id="rubberChart"></canvas>
        </div>

        <div class="legend" aria-hidden="true">
            <div class="legend-item">
                <div class="legend-marker"></div>
                <span data-i18n="legendPimplesIn">Pimples-in</span>
            </div>
            <div class="legend-item">
                <div class="legend-marker hybrid"></div>
                <span data-i18n="legendHybrid">Hybrid</span>
            </div>
        </div>

    </section>

    <!-- Rubber compare panel (loaded from /rubbers/<lang>/*.md and /rubbers/comparison/<lang>/*.md) -->
    <section id="rubberCompare" class="rubber-details rubber-compare" aria-live="polite" hidden>
        <div class="rubber-compare__grid">
            <article id="rubberSetA" class="rubber-compare__card">
                <div class="rubber-details__head">
                    <div id="rubberNameA" class="rubber-details__title rubber-compare__name rubber-compare__name--a"></div>
                    <div id="rubberActionsA" class="rubber-details__actions" aria-label="Links"></div>
                </div>
                <div id="rubberDetailsBodyA" class="rubber-details__body"></div>
            </article>

            <article id="rubberSetB" class="rubber-compare__card" hidden>
                <div class="rubber-details__head">
                    <div id="rubberNameB" class="rubber-details__title rubber-compare__name rubber-compare__name--b"></div>
                    <div id="rubberActionsB" class="rubber-details__actions" aria-label="Links"></div>
                </div>
                <div id="rubberDetailsBodyB" class="rubber-details__body"></div>
            </article>
        </div>

        <article id="rubberComparison" class="rubber-compare__comparison" hidden>
            <div class="rubber-details__head rubber-compare__comparison-head">
                <div id="rubberComparisonTitle" class="rubber-details__title rubber-compare__compare-title"></div>
            </div>
            <div id="rubberComparisonBody" class="rubber-details__body"></div>
        </article>
    </section>

 </div>

<script>
    (function () {
        const v = document.querySelector('meta[name="app-version"]')?.content || "";
        const qs = v ? `?v=${encodeURIComponent(v)}` : "";
        const s = document.createElement("script");
        s.type = "module";
        s.src = `js/main.js${qs}`;
        document.body.appendChild(s);
    })();
</script>

</body>
</html>
